<template>
  <MultiPicker
    v-model="pickerValue"
    :options="options"
    :field-names="fieldNames"
    title="åŸºç¡€ç”¨æ³•"
    show-search
    @search="onSearch"
  >
    <template #trigger="{ triggerPopupShow, showValue }">
      <div class="trigger-box">
        <van-button type="primary" @click="triggerPopupShow"> å¸¦æœç´¢æ¡†ğŸ” </van-button>
        <p>show value: {{ showValue }}</p>
        <p>modelValue: {{ pickerValue }}</p>
      </div>
    </template>
  </MultiPicker>
</template>

<script setup lang="ts">
import { useWrapperRef } from '@vmono/vhooks';
import { MultiPicker } from '@vmono/vant-kit';
import { Button as VanButton } from 'vant';
import { checkStrIsEmpty } from '@vmono/utils';

const optionsDataSource = [
  { name: 'é€‰é¡¹1', value: '1' },
  { name: 'é€‰é¡¹2', value: '2', disabled: true },
  { name: 'é€‰é¡¹3', value: '3' },
  { name: 'é€‰é¡¹4', value: '4', disabled: true },
  { name: 'é€‰é¡¹5', value: '5' },
  { name: 'é€‰é¡¹6', value: '6' },
  { name: 'é€‰é¡¹7', value: '7', disabled: true },
  { name: 'é€‰é¡¹8', value: '8' },
  { name: 'é€‰é¡¹9', value: '9' },
  { name: 'é€‰é¡¹10', value: '10' },
  { name: 'é€‰é¡¹11', value: '11', disabled: true },
  { name: 'é€‰é¡¹12', value: '12' },
  { name: 'é€‰é¡¹13', value: '13', disabled: true },
  { name: 'é€‰é¡¹14', value: '14' },
  { name: 'é€‰é¡¹15', value: '15' },
  { name: 'é€‰é¡¹16', value: '16', disabled: true },
  { name: 'é€‰é¡¹17', value: '17' },
  { name: 'é€‰é¡¹18', value: '18' },
  { name: 'é€‰é¡¹19', value: '19' },
  { name: 'é€‰é¡¹20', value: '20' },
];
const [options, setOptions] = useWrapperRef(optionsDataSource);

const fieldNames = {
  label: 'name',
  value: 'value',
};
const [pickerValue, _setPickerValue] = useWrapperRef<string[]>([]);

const onSearch = (keywords: string) => {
  if (checkStrIsEmpty(keywords)) {
    setOptions(optionsDataSource);
  } else {
    setOptions(
      optionsDataSource.filter((item) => item.name.toLocaleLowerCase().includes(keywords.toLocaleLowerCase()))
    );
  }
};
</script>

<style scoped lang="less">
.trigger-box {
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
}
</style>
